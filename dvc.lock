schema: '2.0'
stages:
  fetch_data:
    cmd: python scripts/fetch_arxiv_data.py --query "cat:eess.IV OR cat:cs.CV OR cat:q-bio.QM
      OR cat:cs.LG" --max-results 100 --output-dir data/raw
    deps:
    - path: scripts/fetch_arxiv_data.py
      hash: md5
      md5: f8f702789871bda59a32d483df30a600
      size: 13353
    params:
      params.yaml:
        data.max_results: 100
        data.query: cat:eess.IV OR cat:cs.CV OR cat:q-bio.QM OR cat:cs.LG
    outs:
    - path: data/raw/arxiv_metadata.yaml
      hash: md5
      md5: 53a066c616239e061feaf23bb4febefa
      size: 1406
    - path: data/raw/arxiv_publications.csv
      hash: md5
      md5: 9233ec13f3220815298e716741d7bbe3
      size: 174435
  preprocess:
    cmd: python scripts/preprocess_data.py --input data/raw/arxiv_publications.csv
      --output data/processed/publications_processed.csv
    deps:
    - path: data/raw/arxiv_metadata.yaml
      hash: md5
      md5: 53a066c616239e061feaf23bb4febefa
      size: 1406
    - path: data/raw/arxiv_publications.csv
      hash: md5
      md5: 9233ec13f3220815298e716741d7bbe3
      size: 174435
    - path: scripts/preprocess_data.py
      hash: md5
      md5: 227d7f1c83cd38268b1023da27f21e15
      size: 10035
    params:
      params.yaml:
        feature_engineering.categorical_columns:
        - journal_category
        - year_category
        - author_count_category
        feature_engineering.numerical_columns:
        - year
        - title_length
        - abstract_length
        - author_count
        - num_keywords
        feature_engineering.text_columns:
        - title
        - abstract
        - keywords
    outs:
    - path: data/processed/processing_metadata.yaml
      hash: md5
      md5: f13dd619e661e4455ee483d398e3f176
      size: 706
    - path: data/processed/publications_processed.csv
      hash: md5
      md5: 667e2147a0af914b2eedbcd49dd0e0c6
      size: 320745
  train:
    cmd: python scripts/train_model.py --input data/processed/publications_processed.csv
      --model-output models/classifier.pkl --metrics metrics.json
    deps:
    - path: data/processed/processing_metadata.yaml
      hash: md5
      md5: f13dd619e661e4455ee483d398e3f176
      size: 706
    - path: data/processed/publications_processed.csv
      hash: md5
      md5: 667e2147a0af914b2eedbcd49dd0e0c6
      size: 320745
    - path: scripts/train_model.py
      hash: md5
      md5: 1e1280fa27f0f2e6d042132927d77787
      size: 14779
    params:
      params.yaml:
        mlflow.experiment_name: arxiv_publications_classification
        mlflow.tracking_uri: file:./mlruns
        train.algorithm: RandomForestClassifier
        train.random_forest:
          n_estimators: 100
          max_depth: 10
          min_samples_split: 5
          min_samples_leaf: 2
          max_features: sqrt
          bootstrap: true
          oob_score: true
        train.random_state: 42
        train.test_size: 0.2
    outs:
    - path: metrics.json
      hash: md5
      md5: 07a34a69a501070c53d035e777818cae
      size: 519
    - path: models/classifier.pkl
      hash: md5
      md5: c03b2c33cef60525617d8cdd6431e8df
      size: 1176825
    - path: models/classifier_metadata.yaml
      hash: md5
      md5: f5aa27515d75ab75af21a19219dc0d35
      size: 1299
